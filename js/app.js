angular.module("CompuCorpApp",["ngResource","ui.router"]),angular.module("CompuCorpApp").directive("card",[function(){return{restrict:"E",templateUrl:"src/app/directives/card/directive.html",scope:{card:"="},link:function(e){e.getImage=function(){if(e.card.images.length)return e.card.images[0].url}}}}]),angular.module("CompuCorpApp").directive("searchBox",[function(){return{restrict:"E",templateUrl:"src/app/directives/searchbox/directive.html",scope:{ngModel:"=",onSearch:"=",placeholder:"@",isSearching:"="}}}]),angular.module("CompuCorpApp").controller("HomeController",["searchService","albumService","artistService",function(e,r,t){function i(){return e.api.get({q:l.search.q,type:l.search.type,limit:l.search.limit,offset:l.search.offset}).$promise.then(function(e){Array.prototype.push.apply(l.search.data,e.albums.items),Array.prototype.push.apply(l.search.data,e.artists.items),l.search.offset+=l.search.limit})}function a(){l.search.q&&(l.isSearching=!0,l.search.data=[],i().then(function(){l.isSearching=!1}))}function o(){l.isLoadingMore=!0,i().then(function(){l.isLoadingMore=!1})}function c(e){l.selectedCard=e,console.log(e.type),l.tracks=null,l.albums=null,"album"===e.type?r.api.getTracks({id:e.id}).$promise.then(function(e){l.tracks=e.items,l.modalShow=!0}):"artist"===e.type&&t.api.getAlbums({id:e.id}).$promise.then(function(e){l.albums=e.items,l.modalShow=!0})}function s(e){return e.images.length?e.images[0].url:""}var l=this;l.search={offset:0,limit:6,q:"",type:"album,artist"},l.isSearching=!1,l.isLoadingMore=!1,l.onSearch=a.bind(l),l.onCardSelect=c.bind(l),l.getImage=s.bind(l),l.onLoadMore=o.bind(l),l.onSearch()}]),angular.module("CompuCorpApp").directive("modalDialog",function(){return{restrict:"E",scope:{show:"="},replace:!0,transclude:!0,link:function(e,r,t){e.dialogStyle={},t.width&&(e.dialogStyle.width=t.width),t.height&&(e.dialogStyle.height=t.height),e.hideModal=function(){e.show=!1}},templateUrl:"src/app/directives/modaldialog/directive.html"}}),angular.module("CompuCorpApp").directive("cardList",[function(){return{restrict:"E",templateUrl:"src/app/directives/cardlist/directive.html",scope:{cards:"=",onCardSelect:"="}}}]),angular.module("CompuCorpApp").service("searchService",["$resource","apiBaseUrl",function(e,r){var t=r+"search";this.api=e(t)}]),angular.module("CompuCorpApp").service("artistService",["$resource","apiBaseUrl",function(e,r){var t=r+"artists";this.api=e(t,{id:"@id"},{getAlbums:{url:t+"/:id/albums"}})}]),angular.module("CompuCorpApp").service("albumService",["$resource","apiBaseUrl",function(e,r){var t=r+"albums";this.api=e(t,{id:"@id"},{getTracks:{url:t+"/:id/tracks"}})}]),angular.module("CompuCorpApp").config(["$stateProvider","$urlRouterProvider",function(e,r){e.state("home",{url:"",templateUrl:"src/app/routes/home/controller.html",controller:"HomeController",controllerAs:"vm"})}]).constant("apiBaseUrl","https://api.spotify.com/v1/");